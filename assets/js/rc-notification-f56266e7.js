import{c as e,g as t,b as n,d as o,h as r,e as c,f as a}from"./@babel-7994ac7b.js";import{r as s,a as i}from"./react-32c7b601.js";import{r as l}from"./react-dom-23648d3c.js";import{c as u}from"./classnames-a0172216.js";import{a as f}from"./rc-motion-254b4328.js";import{K as d}from"./rc-util-fa3fab39.js";var m=s.forwardRef((function(o,r){var c=o.prefixCls,a=o.style,i=o.className,l=o.duration,f=void 0===l?4.5:l,m=o.eventKey,v=o.content,y=o.closable,p=o.closeIcon,h=void 0===p?"x":p,k=o.props,g=o.onClick,N=o.onNoticeClose,E=o.times,C=o.hovering,x=s.useState(!1),b=e(x,2),R=b[0],j=b[1],A=C||R,S=function(){N(m)};s.useEffect((function(){if(!A&&f>0){var e=setTimeout((function(){S()}),1e3*f);return function(){clearTimeout(e)}}}),[f,A,E]);var w="".concat(c,"-notice");return s.createElement("div",t({},k,{ref:r,className:u(w,i,n({},"".concat(w,"-closable"),y)),style:a,onMouseEnter:function(e){var t;j(!0),null==k||null===(t=k.onMouseEnter)||void 0===t||t.call(k,e)},onMouseLeave:function(e){var t;j(!1),null==k||null===(t=k.onMouseLeave)||void 0===t||t.call(k,e)},onClick:g}),s.createElement("div",{className:"".concat(w,"-content")},v),y&&s.createElement("a",{tabIndex:0,className:"".concat(w,"-close"),onKeyDown:function(e){"Enter"!==e.key&&"Enter"!==e.code&&e.keyCode!==d.ENTER||S()},onClick:function(e){e.preventDefault(),e.stopPropagation(),S()}},h))})),v=i.createContext({}),y=function(e){var t=e.children,n=e.classNames;return i.createElement(v.Provider,{value:{classNames:n}},t)},p=["className","style","classNames","styles"],h=function(l){var d,y,h,k,g,N,E=l.configList,C=l.placement,x=l.prefixCls,b=l.className,R=l.style,j=l.motion,A=l.onAllNoticeRemoved,S=l.onNoticeClose,w=l.stack,M=s.useContext(v).classNames,I=s.useRef({}),L=s.useState(null),W=e(L,2),H=W[0],K=W[1],O=s.useState([]),P=e(O,2),T=P[0],D=P[1],F=E.map((function(e){return{config:e,key:String(e.key)}})),X=(N={offset:8,threshold:3,gap:16},(y=w)&&"object"===o(y)&&(N.offset=null!==(h=y.offset)&&void 0!==h?h:8,N.threshold=null!==(k=y.threshold)&&void 0!==k?k:3,N.gap=null!==(g=y.gap)&&void 0!==g?g:16),[!!y,N]),q=e(X,2),z=q[0],B=q[1],G=B.offset,J=B.threshold,Q=B.gap,U=z&&(T.length>0||F.length<=J),V="function"==typeof j?j(C):j;return s.useEffect((function(){z&&T.length>1&&D((function(e){return e.filter((function(e){return F.some((function(t){var n=t.key;return e===n}))}))}))}),[T,F,z]),s.useEffect((function(){var e,t;z&&I.current[null===(e=F[F.length-1])||void 0===e?void 0:e.key]&&K(I.current[null===(t=F[F.length-1])||void 0===t?void 0:t.key])}),[F,z]),i.createElement(f,t({key:C,className:u(x,"".concat(x,"-").concat(C),null==M?void 0:M.list,b,(d={},n(d,"".concat(x,"-stack"),!!z),n(d,"".concat(x,"-stack-expanded"),U),d)),style:R,keys:F,motionAppear:!0},V,{onAllRemoved:function(){A(C)}}),(function(e,n){var o=e.config,s=e.className,l=e.style,f=e.index,d=o,v=d.key,y=d.times,h=String(v),k=o,g=k.className,N=k.style,E=k.classNames,b=k.styles,R=r(k,p),j=F.findIndex((function(e){return e.key===h})),A={};if(z){var w=F.length-1-(j>-1?j:f-1),L="top"===C||"bottom"===C?"-50%":"0";if(w>0){var W,K,O;A.height=U?null===(W=I.current[h])||void 0===W?void 0:W.offsetHeight:null==H?void 0:H.offsetHeight;for(var P=0,X=0;X<w;X++){var q;P+=(null===(q=I.current[F[F.length-1-X].key])||void 0===q?void 0:q.offsetHeight)+Q}var B=(U?P:w*G)*(C.startsWith("top")?1:-1),J=!U&&null!=H&&H.offsetWidth&&null!==(K=I.current[h])&&void 0!==K&&K.offsetWidth?((null==H?void 0:H.offsetWidth)-2*G*(w<3?w:3))/(null===(O=I.current[h])||void 0===O?void 0:O.offsetWidth):1;A.transform="translate3d(".concat(L,", ").concat(B,"px, 0) scaleX(").concat(J,")")}else A.transform="translate3d(".concat(L,", 0, 0)")}return i.createElement("div",{ref:n,className:u("".concat(x,"-notice-wrapper"),s,null==E?void 0:E.wrapper),style:c(c(c({},l),A),null==b?void 0:b.wrapper),onMouseEnter:function(){return D((function(e){return e.includes(h)?e:[].concat(a(e),[h])}))},onMouseLeave:function(){return D((function(e){return e.filter((function(e){return e!==h}))}))}},i.createElement(m,t({},R,{ref:function(e){j>-1?I.current[h]=e:delete I.current[h]},prefixCls:x,classNames:E,styles:b,className:u(g,null==M?void 0:M.notice),style:N,times:y,key:v,eventKey:v,onNoticeClose:S,hovering:z&&T.length>0})))}))},k=s.forwardRef((function(t,n){var o=t.prefixCls,r=void 0===o?"rc-notification":o,i=t.container,u=t.motion,f=t.maxCount,d=t.className,m=t.style,v=t.onAllRemoved,y=t.stack,p=t.renderNotifications,k=s.useState([]),g=e(k,2),N=g[0],E=g[1],C=function(e){var t,n=N.find((function(t){return t.key===e}));null==n||null===(t=n.onClose)||void 0===t||t.call(n),E((function(t){return t.filter((function(t){return t.key!==e}))}))};s.useImperativeHandle(n,(function(){return{open:function(e){E((function(t){var n,o=a(t),r=o.findIndex((function(t){return t.key===e.key})),s=c({},e);r>=0?(s.times=((null===(n=t[r])||void 0===n?void 0:n.times)||0)+1,o[r]=s):(s.times=0,o.push(s));return f>0&&o.length>f&&(o=o.slice(-f)),o}))},close:function(e){C(e)},destroy:function(){E([])}}}));var x=s.useState({}),b=e(x,2),R=b[0],j=b[1];s.useEffect((function(){var e={};N.forEach((function(t){var n=t.placement,o=void 0===n?"topRight":n;o&&(e[o]=e[o]||[],e[o].push(t))})),Object.keys(R).forEach((function(t){e[t]=e[t]||[]})),j(e)}),[N]);var A=function(e){j((function(t){var n=c({},t);return(n[e]||[]).length||delete n[e],n}))},S=s.useRef(!1);if(s.useEffect((function(){Object.keys(R).length>0?S.current=!0:S.current&&(null==v||v(),S.current=!1)}),[R]),!i)return null;var w=Object.keys(R);return l.createPortal(s.createElement(s.Fragment,null,w.map((function(e){var t=R[e],n=s.createElement(h,{key:e,configList:t,placement:e,prefixCls:r,className:null==d?void 0:d(e),style:null==m?void 0:m(e),motion:u,onNoticeClose:C,onAllNoticeRemoved:A,stack:y});return p?p(n,{prefixCls:r,key:e}):n}))),i)})),g=["getContainer","motion","prefixCls","maxCount","className","style","onAllRemoved","stack","renderNotifications"],N=function(){return document.body},E=0;function C(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.getContainer,o=void 0===n?N:n,c=t.motion,i=t.prefixCls,l=t.maxCount,u=t.className,f=t.style,d=t.onAllRemoved,m=t.stack,v=t.renderNotifications,y=r(t,g),p=s.useState(),h=e(p,2),C=h[0],x=h[1],b=s.useRef(),R=s.createElement(k,{container:C,ref:b,prefixCls:i,motion:c,maxCount:l,className:u,style:f,onAllRemoved:d,stack:m,renderNotifications:v}),j=s.useState([]),A=e(j,2),S=A[0],w=A[1],M=s.useMemo((function(){return{open:function(e){var t=function(){for(var e={},t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return n.forEach((function(t){t&&Object.keys(t).forEach((function(n){var o=t[n];void 0!==o&&(e[n]=o)}))})),e}(y,e);null!==t.key&&void 0!==t.key||(t.key="rc-notification-".concat(E),E+=1),w((function(e){return[].concat(a(e),[{type:"open",config:t}])}))},close:function(e){w((function(t){return[].concat(a(t),[{type:"close",key:e}])}))},destroy:function(){w((function(e){return[].concat(a(e),[{type:"destroy"}])}))}}}),[]);return s.useEffect((function(){x(o())})),s.useEffect((function(){b.current&&S.length&&(S.forEach((function(e){switch(e.type){case"open":b.current.open(e.config);break;case"close":b.current.close(e.key);break;case"destroy":b.current.destroy()}})),w((function(e){return e.filter((function(e){return!S.includes(e)}))})))}),[S]),[M,R]}export{m as N,y as a,C as u};
