import{h as e,c as t,d as n,e as a,g as r,b as o,f as i}from"./@babel-7994ac7b.js";import{c as l}from"./classnames-a0172216.js";import{u,B as s,r as c}from"./rc-input-84597cfb.js";import{B as d,a as f,q as m}from"./rc-util-fa3fab39.js";import{r as p,a as g}from"./react-32c7b601.js";import{R as v}from"./rc-resize-observer-c51b26ea.js";var h,b=["letter-spacing","line-height","padding-top","padding-bottom","font-family","font-weight","font-size","font-variant","text-rendering","text-transform","width","text-indent","padding-left","padding-right","border-width","box-sizing","word-break","white-space"],x={};function w(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;h||((h=document.createElement("textarea")).setAttribute("tab-index","-1"),h.setAttribute("aria-hidden","true"),document.body.appendChild(h)),e.getAttribute("wrap")?h.setAttribute("wrap",e.getAttribute("wrap")):h.removeAttribute("wrap");var r=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.getAttribute("id")||e.getAttribute("data-reactid")||e.getAttribute("name");if(t&&x[n])return x[n];var a=window.getComputedStyle(e),r=a.getPropertyValue("box-sizing")||a.getPropertyValue("-moz-box-sizing")||a.getPropertyValue("-webkit-box-sizing"),o=parseFloat(a.getPropertyValue("padding-bottom"))+parseFloat(a.getPropertyValue("padding-top")),i=parseFloat(a.getPropertyValue("border-bottom-width"))+parseFloat(a.getPropertyValue("border-top-width")),l={sizingStyle:b.map((function(e){return"".concat(e,":").concat(a.getPropertyValue(e))})).join(";"),paddingSize:o,borderSize:i,boxSizing:r};return t&&n&&(x[n]=l),l}(e,t),o=r.paddingSize,i=r.borderSize,l=r.boxSizing,u=r.sizingStyle;h.setAttribute("style","".concat(u,";").concat("\n  min-height:0 !important;\n  max-height:none !important;\n  height:0 !important;\n  visibility:hidden !important;\n  overflow:hidden !important;\n  position:absolute !important;\n  z-index:-1000 !important;\n  top:0 !important;\n  right:0 !important;\n  pointer-events: none !important;\n")),h.value=e.value||e.placeholder||"";var s,c=void 0,d=void 0,f=h.scrollHeight;if("border-box"===l?f+=i:"content-box"===l&&(f-=o),null!==n||null!==a){h.value=" ";var m=h.scrollHeight-o;null!==n&&(c=m*n,"border-box"===l&&(c=c+o+i),f=Math.max(c,f)),null!==a&&(d=m*a,"border-box"===l&&(d=d+o+i),s=f>d?"":"hidden",f=Math.min(d,f))}var p={height:f,overflowY:s,resize:"none"};return c&&(p.minHeight=c),d&&(p.maxHeight=d),p}var y=["prefixCls","onPressEnter","defaultValue","value","autoSize","onResize","className","style","disabled","onChange","onInternalAutoSize"],z=p.forwardRef((function(i,u){var s=i,c=s.prefixCls;s.onPressEnter;var g=s.defaultValue,h=s.value,b=s.autoSize,x=s.onResize,z=s.className,S=s.style,C=s.disabled,E=s.onChange;s.onInternalAutoSize;var R=e(s,y),A=d(g,{value:h,postState:function(e){return null!=e?e:""}}),V=t(A,2),F=V[0],N=V[1],P=p.useRef();p.useImperativeHandle(u,(function(){return{textArea:P.current}}));var j=p.useMemo((function(){return b&&"object"===n(b)?[b.minRows,b.maxRows]:[]}),[b]),H=t(j,2),T=H[0],B=H[1],I=!!b,L=p.useState(2),k=t(L,2),M=k[0],W=k[1],D=p.useState(),K=t(D,2),Y=K[0],q=K[1],X=function(){W(0)};f((function(){I&&X()}),[h,T,B,I]),f((function(){if(0===M)W(1);else if(1===M){var e=w(P.current,!1,T,B);W(2),q(e)}else!function(){try{if(document.activeElement===P.current){var e=P.current,t=e.selectionStart,n=e.selectionEnd,a=e.scrollTop;P.current.setSelectionRange(t,n),P.current.scrollTop=a}}catch(r){}}()}),[M]);var G=p.useRef(),J=function(){m.cancel(G.current)};p.useEffect((function(){return J}),[]);var O=I?Y:null,Q=a(a({},S),O);return 0!==M&&1!==M||(Q.overflowY="hidden",Q.overflowX="hidden"),p.createElement(v,{onResize:function(e){2===M&&(null==x||x(e),b&&(J(),G.current=m((function(){X()}))))},disabled:!(b||x)},p.createElement("textarea",r({},R,{ref:P,style:Q,className:l(c,z,o({},"".concat(c,"-disabled"),C)),disabled:C,value:F,onChange:function(e){N(e.target.value),null==E||E(e)}})))})),S=["defaultValue","value","onFocus","onBlur","onChange","allowClear","maxLength","onCompositionStart","onCompositionEnd","suffix","prefixCls","showCount","count","className","style","disabled","hidden","classNames","styles","onResize"],C=g.forwardRef((function(n,f){var m,v,h=n.defaultValue,b=n.value,x=n.onFocus,w=n.onBlur,y=n.onChange,C=n.allowClear,E=n.maxLength,R=n.onCompositionStart,A=n.onCompositionEnd,V=n.suffix,F=n.prefixCls,N=void 0===F?"rc-textarea":F,P=n.showCount,j=n.count,H=n.className,T=n.style,B=n.disabled,I=n.hidden,L=n.classNames,k=n.styles,M=n.onResize,W=e(n,S),D=d(h,{value:b,defaultValue:h}),K=t(D,2),Y=K[0],q=K[1],X=null==Y?"":String(Y),G=g.useState(!1),J=t(G,2),O=J[0],Q=J[1],U=g.useRef(!1),Z=g.useState(null),$=t(Z,2),_=$[0],ee=$[1],te=p.useRef(null),ne=function(){var e;return null===(e=te.current)||void 0===e?void 0:e.textArea},ae=function(){ne().focus()};p.useImperativeHandle(f,(function(){return{resizableTextArea:te.current,focus:ae,blur:function(){ne().blur()}}})),p.useEffect((function(){Q((function(e){return!B&&e}))}),[B]);var re=g.useState(null),oe=t(re,2),ie=oe[0],le=oe[1];g.useEffect((function(){var e;ie&&(e=ne()).setSelectionRange.apply(e,i(ie))}),[ie]);var ue,se=u(j,P),ce=null!==(m=se.max)&&void 0!==m?m:E,de=Number(ce)>0,fe=se.strategy(X),me=!!ce&&fe>ce,pe=function(e,t){var n=t;!U.current&&se.exceedFormatter&&se.max&&se.strategy(t)>se.max&&t!==(n=se.exceedFormatter(t,{max:se.max}))&&le([ne().selectionStart||0,ne().selectionEnd||0]),q(n),c(e.currentTarget,e,y,n)},ge=V;se.show&&(ue=se.showFormatter?se.showFormatter({value:X,count:fe,maxLength:ce}):"".concat(fe).concat(de?" / ".concat(ce):""),ge=g.createElement(g.Fragment,null,ge,g.createElement("span",{className:l("".concat(N,"-data-count"),null==L?void 0:L.count),style:null==k?void 0:k.count},ue)));var ve=!W.autoSize&&!P&&!C;return g.createElement(s,{value:X,allowClear:C,handleReset:function(e){q(""),ae(),c(ne(),e,y)},suffix:ge,prefixCls:N,classNames:a(a({},L),{},{affixWrapper:l(null==L?void 0:L.affixWrapper,(v={},o(v,"".concat(N,"-show-count"),P),o(v,"".concat(N,"-textarea-allow-clear"),C),v))}),disabled:B,focused:O,className:l(H,me&&"".concat(N,"-out-of-range")),style:a(a({},T),_&&!ve?{height:"auto"}:{}),dataAttrs:{affixWrapper:{"data-count":"string"==typeof ue?ue:void 0}},hidden:I},g.createElement(z,r({},W,{maxLength:E,onKeyDown:function(e){var t=W.onPressEnter,n=W.onKeyDown;"Enter"===e.key&&t&&t(e),null==n||n(e)},onChange:function(e){pe(e,e.target.value)},onFocus:function(e){Q(!0),null==x||x(e)},onBlur:function(e){Q(!1),null==w||w(e)},onCompositionStart:function(e){U.current=!0,null==R||R(e)},onCompositionEnd:function(e){U.current=!1,pe(e,e.currentTarget.value),null==A||A(e)},className:l(null==L?void 0:L.textarea),style:a(a({},null==k?void 0:k.textarea),{},{resize:null==T?void 0:T.resize}),disabled:B,prefixCls:N,onResize:function(e){var t;null==M||M(e),null!==(t=ne())&&void 0!==t&&t.style.height&&ee(!0)},ref:te})))}));export{C as T};
